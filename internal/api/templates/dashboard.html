<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Baseball API - Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Google+Sans+Code:wght@400;500;700&display=swap"
      rel="stylesheet" />
    <link rel="stylesheet" href="/static/css/ui.css" />
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  </head>

  <body data-authenticated="{{if .User}}true{{else}}false{{end}}">
    <nav class="navbar navbar-dark bg-dark">
      <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">Baseball API Dashboard</span>
        <div class="d-flex align-items-center">
          <a href="/examples" class="btn btn-outline-light me-2">Chart Examples</a>
          {{if .User}}
          <span class="navbar-text me-3 text-light">
            {{if .User.AvatarURL}}<img
              src="{{.User.AvatarURL}}"
              class="rounded-circle me-2"
              width="32"
              height="32" />{{end}} {{.User.Email}}
          </span>
          <button
            class="btn btn-outline-light"
            hx-post="/v1/auth/logout"
            hx-swap="none"
            onclick="window.location.href='/login'">
            Logout
          </button>
          {{else}}
          <a href="/login" class="btn btn-outline-light">Login</a>
          {{end}}
        </div>
      </div>
    </nav>

    <div class="container mt-4">
      {{if .User}}
      <div class="row">
        <div class="col-md-12">
          <h2>API Keys</h2>
          <p class="text-muted">Generate and manage API keys for programmatic access to the Baseball API.</p>

          <div class="card mb-4">
            <div class="card-header">
              <h5 class="mb-0">Generate New API Key</h5>
            </div>
            <div class="card-body">
              <form id="create-key-form">
                <div class="mb-3">
                  <label for="key-name" class="form-label">Key Name (Optional)</label>
                  <input
                    type="text"
                    class="form-control"
                    id="key-name"
                    name="name"
                    placeholder="e.g., Production Server" />
                </div>
                <button type="submit" class="btn btn-primary">Generate Key</button>
              </form>
              <div id="new-key-result" class="mt-3"></div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">Your API Keys</h5>
            </div>
            <div class="card-body" id="api-keys-list">
              <div class="text-center">
                <div class="spinner-border" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      {{else}}
      <div class="alert alert-warning">
        You must be logged in to access the dashboard. <a href="/login">Login here</a>.
      </div>
      {{end}}
    </div>

    <script defer src="/static/js/dashboard.js"></script>
  </body>
</html>
