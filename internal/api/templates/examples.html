{{define "examples.html"}}
{{template "base" .}}
{{end}}

{{define "title"}}Baseball API - Basic Charts{{end}}

{{define "body_attrs"}}data-page="examples-basic"{{end}}

{{define "main_attrs"}}x-data="basicStatsApp()" x-init="init()"{{end}}

{{define "head_extra"}}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script defer src="/static/js/examples.js"></script>
{{end}}

{{define "content"}}
<div class="stack">
  <section class="panel">
    <h2>Season Pitching Leaders</h2>
    <p>Fetch strikeout leaders per season and render as a horizontal bar chart.</p>
    <div class="form-grid">
      <div class="field">
        <label for="pitchingYear">Season</label>
        <input type="number" id="pitchingYear" x-model.number="pitchingYear" min="1871" max="2024" />
      </div>
      <div class="field">
        <label for="pitchingLeague">League</label>
        <select id="pitchingLeague" x-model="pitchingLeague">
          <option value="">Both Leagues</option>
          <option value="AL">American League</option>
          <option value="NL">National League</option>
        </select>
      </div>
    </div>
    <button class="btn btn-primary" style="margin-top: 1rem" @click="loadPitchingLeaders()">Load Leaders</button>
    <div class="table-container" style="margin-top: 1.25rem" x-show="pitchingRows.length">
      <table class="data-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Player</th>
            <th>Team</th>
            <th>Strikeouts</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="(row, idx) in pitchingRows" :key="row.player_id">
            <tr>
              <td x-text="idx + 1"></td>
              <td x-text="row.player_id || 'Unknown'"></td>
              <td x-text="row.team || row.team_id || '—'"></td>
              <td x-text="row.so || 0"></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
    <p class="muted" x-show="!pitchingRows.length" style="margin-top: 1.5rem">
      Run the query to populate the table and chart.
    </p>
    <div class="chart-frame" x-show="pitchingChart">
      <canvas id="pitchingChart" x-ref="pitchingChart"></canvas>
    </div>
    <div x-show="pitchingEndpoint" class="stack" style="gap: 0.5rem; margin-top: 1rem">
      <div class="endpoint">
        <strong>GET</strong>
        <code x-text="pitchingEndpoint"></code>
      </div>
      <button class="btn btn-compact" @click="showPitchingJSON = !showPitchingJSON">
        <span x-text="showPitchingJSON ? 'Hide Sample JSON' : 'Show Sample JSON'"></span>
      </button>
      <div class="json-display" x-show="showPitchingJSON" x-html="pitchingJSON"></div>
    </div>
  </section>

  <section class="panel">
    <h2>Season Batting Leaders</h2>
    <p>Select a batting stat and quickly compare the top performers.</p>
    <div class="form-grid">
      <div class="field">
        <label for="leaderYear">Season</label>
        <input type="number" id="leaderYear" x-model.number="leaderYear" min="1871" max="2024" />
      </div>
      <div class="field">
        <label for="leaderStat">Stat</label>
        <select id="leaderStat" x-model="leaderStat">
          <option value="hr">Home Runs</option>
          <option value="avg">Batting Average</option>
          <option value="rbi">Runs Batted In</option>
          <option value="sb">Stolen Bases</option>
          <option value="ops">OPS</option>
        </select>
      </div>
      <div class="field">
        <label for="league">League</label>
        <select id="league" x-model="league">
          <option value="">Both Leagues</option>
          <option value="AL">American League</option>
          <option value="NL">National League</option>
        </select>
      </div>
    </div>
    <button class="btn btn-primary" style="margin-top: 1rem" @click="loadBattingLeaders()">Load Leaders</button>
    <div class="table-container" style="margin-top: 1.25rem" x-show="leadersRows.length">
      <table class="data-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Player</th>
            <th>Team</th>
            <th x-text="leaderStat.toUpperCase()"></th>
          </tr>
        </thead>
        <tbody>
          <template x-for="(row, idx) in leadersRows" :key="row.player_id + idx">
            <tr>
              <td x-text="idx + 1"></td>
              <td x-text="row.player_id || 'Unknown'"></td>
              <td x-text="row.team || row.team_id || '—'"></td>
              <td x-text="formatStat(row, leaderStat)"></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
    <p class="muted" x-show="!leadersRows.length" style="margin-top: 1.5rem">
      Request a leaderboard to populate the table and chart.
    </p>
    <div class="chart-frame" x-show="leadersChart">
      <canvas id="leadersChart" x-ref="leadersChart"></canvas>
    </div>
    <div x-show="leadersEndpoint" class="stack" style="gap: 0.5rem; margin-top: 1rem">
      <div class="endpoint">
        <strong>GET</strong>
        <code x-text="leadersEndpoint"></code>
      </div>
      <button class="btn btn-compact" @click="showLeadersJSON = !showLeadersJSON">
        <span x-text="showLeadersJSON ? 'Hide Sample JSON' : 'Show Sample JSON'"></span>
      </button>
      <div class="json-display" x-show="showLeadersJSON" x-html="leadersJSON"></div>
    </div>
  </section>

  <section class="panel">
    <h2>Player Career Progression</h2>
    <p>Plot a player's year-by-year batting or pitching line.</p>
    <div class="form-grid">
      <div class="field">
        <label for="playerId">Player ID</label>
        <input type="text" id="playerId" x-model="playerId" placeholder="e.g. troutmi01" />
      </div>
      <div class="field">
        <label for="playerStatType">Stat Type</label>
        <select id="playerStatType" x-model="playerStatType">
          <option value="batting">Batting</option>
          <option value="pitching">Pitching</option>
        </select>
      </div>
    </div>
    <button class="btn btn-primary" style="margin-top: 1rem" @click="loadPlayerCareer()">Load Career</button>
    <p class="muted" x-show="!playerChart && !playerError" style="margin-top: 1rem">
      Provide a player id (like <code>ruthba01</code>) and choose the stat split to begin.
    </p>
    <div class="alert danger" x-show="playerError" style="margin-top: 1rem" x-text="playerError"></div>
    <div class="table-container" style="margin-top: 1.25rem" x-show="playerRows.length">
      <table class="data-table" x-show="playerStatType === 'batting'">
        <thead>
          <tr>
            <th>Year</th>
            <th>Team</th>
            <th>AVG</th>
            <th>OBP</th>
            <th>SLG</th>
            <th>HR</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="season in playerRows" :key="season.year + season.team_id">
            <tr>
              <td x-text="season.year"></td>
              <td x-text="season.team || season.team_id || '—'"></td>
              <td x-text="formatRate(season.avg)"></td>
              <td x-text="formatRate(season.obp)"></td>
              <td x-text="formatRate(season.slg)"></td>
              <td x-text="season.hr"></td>
            </tr>
          </template>
        </tbody>
      </table>
      <table class="data-table" x-show="playerStatType === 'pitching'">
        <thead>
          <tr>
            <th>Year</th>
            <th>Team</th>
            <th>ERA</th>
            <th>WHIP</th>
            <th>K/9</th>
            <th>IP</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="season in playerRows" :key="season.year + season.team_id + '-pitching'">
            <tr>
              <td x-text="season.year"></td>
              <td x-text="season.team || season.team_id || '—'"></td>
              <td x-text="formatRate(season.era)"></td>
              <td x-text="formatRate(season.whip)"></td>
              <td x-text="formatRate(season.k_per_9)"></td>
              <td x-text="season.ip"></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
    <div class="chart-frame" x-show="playerChart">
      <canvas id="playerChart" x-ref="playerChart"></canvas>
    </div>
    <div x-show="playerEndpoint" class="stack" style="gap: 0.5rem; margin-top: 1rem">
      <div class="endpoint">
        <strong>GET</strong>
        <code x-text="playerEndpoint"></code>
      </div>
      <button class="btn btn-compact" @click="showPlayerJSON = !showPlayerJSON">
        <span x-text="showPlayerJSON ? 'Hide Sample JSON' : 'Show Sample JSON'"></span>
      </button>
      <div class="json-display" x-show="showPlayerJSON" x-html="playerJSON"></div>
    </div>
  </section>
</div>
{{end}}
